2026-02-15 07:30:45.352 | INFO     | application.routes:run_upgrade:51 - Migrations applied successfully
2026-02-15 07:31:19.641 | INFO     | application.routes:upload_media:168 - Image: 1 saved successful.
2026-02-15 07:31:19.655 | INFO     | application.routes:add_tweet:121 - Request completed: api/post/tweet
2026-02-15 07:31:19.772 | INFO     | application.routes:add_tweet:148 - Tweet 1 successful saved.
2026-02-15 07:31:19.814 | INFO     | application.routes:auth_user:103 - request completed: api/users/me/test_user
2026-02-15 07:31:19.837 | INFO     | application.routes:auth_user:105 - User not found
2026-02-15 08:09:32.357 | INFO     | application.routes:run_upgrade:50 - Migrations applied successfully
2026-02-15 08:09:50.268 | INFO     | application.routes:upload_media:165 - Image: 1 saved successful.
2026-02-15 08:09:50.287 | INFO     | application.routes:add_tweet:120 - Request completed: api/post/tweet
2026-02-15 08:09:50.426 | INFO     | application.routes:add_tweet:145 - Tweet 1 successful saved.
2026-02-15 08:09:50.485 | INFO     | application.routes:auth_user:104 - request completed: api/users/me/test_user
2026-02-15 08:09:50.519 | INFO     | application.routes:auth_user:106 - User not found
2026-02-15 08:10:37.301 | INFO     | application.routes:auth_user:104 - request completed: api/users/me/Slava
2026-02-15 08:10:37.732 | INFO     | application.routes:auth_user:104 - request completed: api/users/me/Slava
2026-02-15 08:17:14.665 | INFO     | application.routes:run_upgrade:50 - Migrations applied successfully
2026-02-15 08:17:24.261 | INFO     | application.routes:upload_media:165 - Image: 1 saved successful.
2026-02-15 08:17:24.278 | INFO     | application.routes:add_tweet:120 - Request completed: api/post/tweet
2026-02-15 08:17:24.471 | INFO     | application.routes:add_tweet:145 - Tweet 1 successful saved.
2026-02-15 08:17:24.549 | INFO     | application.routes:auth_user:104 - request completed: api/users/me/test_user
2026-02-15 08:17:24.570 | INFO     | application.routes:auth_user:106 - User not found
2026-02-15 08:17:30.081 | INFO     | application.routes:auth_user:104 - request completed: api/users/me/Slava
2026-02-15 08:17:30.240 | INFO     | application.routes:auth_user:104 - request completed: api/users/me/Slava
2026-02-15 08:32:40.673 | INFO     | application.routes:run_upgrade:50 - Migrations applied successfully
2026-02-15 08:32:48.634 | INFO     | application.routes:upload_media:165 - Image: 1 saved successful.
2026-02-15 08:32:48.651 | INFO     | application.routes:add_tweet:120 - Request completed: api/post/tweet
2026-02-15 08:32:48.747 | INFO     | application.routes:add_tweet:145 - Tweet 1 successful saved.
2026-02-15 08:32:48.805 | INFO     | application.routes:auth_user:104 - request completed: api/users/me/test_user
2026-02-15 08:32:48.826 | INFO     | application.routes:auth_user:106 - User not found
2026-02-15 08:32:53.989 | INFO     | application.routes:auth_user:104 - request completed: api/users/me/Slava
2026-02-15 08:32:54.131 | INFO     | application.routes:auth_user:104 - request completed: api/users/me/Slava
2026-02-15 08:44:00.661 | INFO     | application.routes:run_upgrade:51 - Migrations applied successfully
2026-02-15 08:44:14.558 | INFO     | application.routes:upload_media:166 - Image: 1 saved successful.
2026-02-15 08:44:14.570 | INFO     | application.routes:add_tweet:121 - Request completed: api/post/tweet
2026-02-15 08:44:14.665 | INFO     | application.routes:add_tweet:146 - Tweet 1 successful saved.
2026-02-15 08:44:14.706 | INFO     | application.routes:auth_user:105 - request completed: api/users/me/test_user
2026-02-15 08:44:14.725 | INFO     | application.routes:auth_user:107 - User not found
2026-02-15 11:06:17.273 | INFO     | application.routes:run_upgrade:53 - Migrations applied successfully
2026-02-15 11:06:34.474 | INFO     | application.routes:upload_media:168 - Image: %s saved successful.
2026-02-15 11:06:34.485 | INFO     | application.routes:add_tweet:123 - Request completed: api/post/tweet
2026-02-15 11:06:34.539 | INFO     | application.routes:add_tweet:148 - Tweet %s successful saved.
2026-02-15 11:06:34.566 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-15 11:06:34.579 | INFO     | application.routes:auth_user:111 - User not found
2026-02-15 11:06:54.239 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-15 11:06:54.350 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-15 11:57:09.654 | INFO     | application.routes:run_upgrade:53 - Migrations applied successfully
2026-02-15 11:57:49.191 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-15 11:57:49.456 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-15 11:57:54.690 | INFO     | application.routes:upload_media:170 - Image: %s saved successful.
2026-02-15 11:57:54.735 | INFO     | application.routes:add_tweet:123 - Request completed: api/post/tweet
2026-02-15 11:57:54.884 | INFO     | application.routes:add_tweet:148 - Tweet %s successful saved.
2026-02-15 11:57:54.919 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-15 11:57:54.931 | INFO     | application.routes:auth_user:111 - User not found
2026-02-15 12:01:18.645 | INFO     | application.routes:run_upgrade:53 - Migrations applied successfully
2026-02-15 12:01:25.843 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-15 12:01:25.894 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-15 12:01:56.170 | INFO     | application.routes:upload_media:170 - Image: %s saved successful.
2026-02-15 12:01:56.177 | INFO     | application.routes:add_tweet:123 - Request completed: api/post/tweet
2026-02-15 12:01:56.226 | INFO     | application.routes:add_tweet:148 - Tweet %s successful saved.
2026-02-15 12:01:56.264 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-15 12:01:56.273 | INFO     | application.routes:auth_user:111 - User not found
2026-02-17 12:40:19.046 | INFO     | application.routes:run_upgrade:53 - Migrations applied successfully
2026-02-17 12:40:50.282 | INFO     | application.routes:upload_media:170 - Image: %s saved successful.
2026-02-17 12:40:50.320 | INFO     | application.routes:add_tweet:123 - Request completed: api/post/tweet
2026-02-17 12:40:50.491 | INFO     | application.routes:add_tweet:148 - Tweet %s successful saved.
2026-02-17 12:40:50.531 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-17 12:40:50.559 | INFO     | application.routes:auth_user:111 - User not found
2026-02-17 12:51:19.507 | INFO     | application.routes:upload_media:170 - Image: %s saved successful.
2026-02-17 12:51:19.513 | INFO     | application.routes:add_tweet:123 - Request completed: api/post/tweet
2026-02-17 12:51:19.571 | INFO     | application.routes:add_tweet:148 - Tweet %s successful saved.
2026-02-17 12:51:19.609 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-17 12:51:19.620 | INFO     | application.routes:auth_user:111 - User not found
2026-02-17 12:51:45.252 | INFO     | application.routes:run_upgrade:53 - Migrations applied successfully
2026-02-17 12:52:14.015 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-17 12:52:14.304 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-18 11:47:12.142 | INFO     | application.routes:run_upgrade:53 - Migrations applied successfully
2026-02-18 11:47:26.808 | INFO     | application.routes:upload_media:170 - Image: %s saved successful.
2026-02-18 11:47:26.849 | INFO     | application.routes:add_tweet:123 - Request completed: api/post/tweet
2026-02-18 11:47:26.947 | INFO     | application.routes:add_tweet:148 - Tweet %s successful saved.
2026-02-18 11:47:27.001 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-18 11:47:27.023 | INFO     | application.routes:auth_user:111 - User not found
2026-02-18 11:48:22.543 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-18 11:48:23.256 | INFO     | application.routes:auth_user:109 - request completed: api/users/me/%s
2026-02-18 11:48:39.794 | INFO     | application.routes:add_tweet:123 - Request completed: api/post/tweet
2026-02-18 11:48:40.115 | INFO     | application.routes:add_tweet:148 - Tweet %s successful saved.
2026-02-18 12:40:59.579 | INFO     | application.routes:run_upgrade:54 - Migrations applied successfully
2026-02-18 12:41:09.530 | INFO     | application.routes:auth_user:110 - request completed: api/users/me/%s
2026-02-18 12:41:09.763 | INFO     | application.routes:auth_user:110 - request completed: api/users/me/%s
2026-02-18 12:41:45.567 | INFO     | application.routes:run_upgrade:54 - Migrations applied successfully
2026-02-18 12:41:56.346 | INFO     | application.routes:upload_media:171 - Image: %s saved successful.
2026-02-18 12:41:56.354 | INFO     | application.routes:add_tweet:124 - Request completed: api/post/tweet
2026-02-18 12:41:56.406 | INFO     | application.routes:add_tweet:149 - Tweet %s successful saved.
2026-02-18 12:41:56.430 | INFO     | application.routes:auth_user:110 - request completed: api/users/me/%s
2026-02-18 12:41:56.440 | INFO     | application.routes:auth_user:112 - User not found
2026-02-18 12:42:19.643 | INFO     | application.routes:auth_user:110 - request completed: api/users/me/%s
2026-02-18 12:42:19.824 | INFO     | application.routes:auth_user:110 - request completed: api/users/me/%s
2026-02-18 13:28:37.249 | INFO     | application.routes:run_upgrade:54 - Migrations applied successfully
2026-02-18 13:28:57.350 | INFO     | application.routes:auth_user:110 - request completed: api/users/me/%s
2026-02-18 13:28:57.863 | INFO     | application.routes:auth_user:110 - request completed: api/users/me/%s
2026-02-19 11:51:47.471 | INFO     | application.routes:run_upgrade:54 - Migrations applied successfully
2026-02-19 11:52:49.410 | INFO     | application.routes:auth_user:110 - request completed: api/users/me/%s
2026-02-19 11:52:50.696 | INFO     | application.routes:auth_user:110 - request completed: api/users/me/%s
2026-02-19 11:53:40.886 | INFO     | application.routes:upload_media:171 - Image: %s saved successful.
2026-02-19 11:53:40.897 | INFO     | application.routes:add_tweet:124 - Request completed: api/post/tweet
2026-02-19 11:53:41.016 | INFO     | application.routes:add_tweet:149 - Tweet %s successful saved.
2026-02-19 11:53:41.061 | INFO     | application.routes:auth_user:110 - request completed: api/users/me/%s
2026-02-19 11:53:41.078 | INFO     | application.routes:auth_user:112 - User not found
2026-02-20 11:52:28.222 | INFO     | application.routes:run_upgrade:54 - Migrations applied successfully
2026-02-20 11:53:04.836 | INFO     | application.routes:upload_media:171 - Image: %s saved successful.
2026-02-20 11:53:04.842 | INFO     | application.routes:add_tweet:124 - Request completed: api/post/tweet
2026-02-20 11:53:04.913 | INFO     | application.routes:add_tweet:149 - Tweet %s successful saved.
2026-02-20 11:53:04.933 | INFO     | application.routes:auth_user:110 - request completed: api/users/me/%s
2026-02-20 11:53:04.941 | INFO     | application.routes:auth_user:112 - User not found
2026-02-20 11:53:59.685 | INFO     | application.routes:auth_user:110 - request completed: api/users/me/%s
2026-02-20 11:53:59.960 | INFO     | application.routes:auth_user:110 - request completed: api/users/me/%s
2026-02-20 12:13:43.626 | INFO     | application.routes:run_upgrade:54 - Migrations applied successfully
2026-02-20 12:15:03.789 | INFO     | application.routes:delete_tweet:240 - User %s delete tweet: id = %s
2026-02-20 12:18:59.463 | INFO     | application.routes:run_upgrade:54 - Migrations applied successfully
2026-02-20 12:19:01.306 | INFO     | application.routes:delete_tweet:241 - User %s delete tweet: id = %s
2026-02-20 12:30:16.431 | INFO     | application.routes:run_upgrade:54 - Migrations applied successfully
2026-02-20 12:31:13.744 | INFO     | application.routes:run_upgrade:54 - Migrations applied successfully
2026-02-20 12:31:23.500 | INFO     | application.routes:delete_tweet:241 - User Slava delete tweet: id = 5
2026-02-20 12:32:44.458 | WARNING  | application.routes:delete_tweet:236 - attempted unauthorized deletion! User:Slava
2026-02-20 12:42:03.875 | INFO     | application.routes:run_upgrade:54 - Migrations applied successfully
2026-02-20 12:42:54.548 | INFO     | application.routes:delete_tweet:241 - User Slava delete tweet: id = 18
2026-02-20 12:47:27.544 | INFO     | application.routes:run_upgrade:54 - Migrations applied successfully
2026-02-20 12:49:28.020 | ERROR    | application.routes:db_error_middleware:90 - Internal Server Error: %s
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/usr/local/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x7d644ba054e0>
  File "/usr/local/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7d644bae77e0>
           └ <SpawnProcess name='SpawnProcess-7' parent=1 started>
  File "/usr/local/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7d644bae6d40>
    └ <SpawnProcess name='SpawnProcess-7' parent=1 started>
  File "/usr/local/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7d644ab6edb0>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-7' parent=1 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-7' parent=1 started>
    │    └ <function subprocess_started at 0x7d644a969120>
    └ <SpawnProcess name='SpawnProcess-7' parent=1 started>
  File "/usr/local/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7d644ba35a00>>
  File "/usr/local/lib/python3.12/site-packages/uvicorn/server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x7d644ab70400>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x7d644ab6edb0>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x7d644ba35a00>
           │           │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x7d644a968720>
           │           └ <uvicorn.server.Server object at 0x7d644ba35a00>
           └ <function run at 0x7d644ad36c00>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x7d644ba80120>
           │      └ <function Runner.run at 0x7d644ad61ee0>
           └ <asyncio.runners.Runner object at 0x7d644bc2f920>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /usr/local/lib/python3.12/site-packages/uvicorn/server.py:71> wai...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x7d644ad4ba60>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7d644bc2f920>
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 678, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7d644ad4b9c0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 645, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7d644ad61800>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1999, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7d644b749e40>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "/usr/local/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "/usr/local/lib/python3.12/site-packages/uvicorn/protocols/http/h11_impl.py", line 410, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7d644ada6e40>
  File "/usr/local/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7d6446d41fd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7d6446d41fd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.27.0.4', 8000), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7d644828deb0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7d644ada6e40>
  File "/usr/local/lib/python3.12/site-packages/fastapi/applications.py", line 1135, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7d6446d41fd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7d6446d41fd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.27.0.4', 8000), 'c...
  File "/usr/local/lib/python3.12/site-packages/starlette/applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7d6446d41fd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7d6446d41fd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.27.0.4', 8000), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7d644819ba10>
          └ <fastapi.applications.FastAPI object at 0x7d644828deb0>
  File "/usr/local/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7d6446d2ac00>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7d6446d41fd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.27.0.4', 8000), 'c...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x7d644828e3c0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7d644819ba10>
  File "/usr/local/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x7d6446d36de0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x7d6446d41d30>
                     │    └ <function db_error_middleware at 0x7d644829b880>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x7d644828e3c0>

> File "/application/application/routes.py", line 80, in db_error_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x7d6446d41d30>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x7d6446d36de0>

  File "/usr/local/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
          │            │       │            │       └ <attribute '__context__' of 'BaseException' objects>
          │            │       │            └ MissingGreenlet("greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place?")
          │            │       └ <attribute '__cause__' of 'BaseException' objects>
          │            └ MissingGreenlet("greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place?")
          └ MissingGreenlet("greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place?")
  File "/usr/local/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x7d6446d36ca0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x7d6446d36d40>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.27.0.4', 8000), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7d644828d370>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x7d644828e3c0>
  File "/usr/local/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x7d6446d36ca0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x7d6446d36d40>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.27.0.4', 8000), 'c...
          │                            │    │    └ <starlette.requests.Request object at 0x7d6446d41340>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7d644828e6f0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7d644828d370>
          └ <function wrap_app_handling_exceptions at 0x7d6449bad940>
  File "/usr/local/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d6446d36a20>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x7d6446d36d40>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.27.0.4', 8000), 'c...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7d644828e6f0>
  File "/usr/local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d6446d36a20>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x7d6446d36d40>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.27.0.4', 8000), 'c...
          │    └ <fastapi.routing.APIRouter object at 0x7d644828ddc0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x7d644828e6f0>
  File "/usr/local/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d6446d36a20>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x7d6446d36d40>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.27.0.4', 8000), 'c...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7d644828ddc0>>
          └ <fastapi.routing.APIRouter object at 0x7d644828ddc0>
  File "/usr/local/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d6446d36a20>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x7d6446d36d40>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.27.0.4', 8000), 'c...
          │     └ <function Route.handle at 0x7d6449baede0>
          └ APIRoute(path='/api/tweets/{tweet_id}', name='delete_tweet', methods=['DELETE'])
  File "/usr/local/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d6446d36a20>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x7d6446d36d40>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.27.0.4', 8000), 'c...
          │    └ <function request_response.<locals>.app at 0x7d64481c1260>
          └ APIRoute(path='/api/tweets/{tweet_id}', name='delete_tweet', methods=['DELETE'])
  File "/usr/local/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d6446d36a20>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x7d6446d36d40>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.27.0.4', 8000), 'c...
          │                            │    └ <starlette.requests.Request object at 0x7d6446d42480>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7d6446d36980>
          └ <function wrap_app_handling_exceptions at 0x7d6449bad940>
  File "/usr/local/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d6446d36840>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x7d6446d36d40>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('172.27.0.4', 8000), 'c...
          └ <function request_response.<locals>.app.<locals>.app at 0x7d6446d36980>
  File "/usr/local/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7d6446d42480>
                     └ <function get_request_handler.<locals>.app at 0x7d64481c1300>
  File "/usr/local/lib/python3.12/site-packages/fastapi/routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7d6449bd0d60>
  File "/usr/local/lib/python3.12/site-packages/fastapi/routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'session': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7d644826a120>, 'tweet_id': 34, 'api_key': 'test'}
                 │         └ <function delete_tweet at 0x7d64481c1080>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='tweet_id', mode='validation', config=None)], quer...

  File "/application/application/routes.py", line 239, in delete_tweet
    for media in tweet.tweet_media_ids:
                 │     └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x7d6448298040>
                 └ <application.models.Tweet object at 0x7d6446da9250>

  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py", line 569, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           │    │        │      └ {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x7d6446d5a1b0>, 'user_id': 1, 'id': 34, 'tweet_data': '...
           │    │        └ <sqlalchemy.orm.state.InstanceState object at 0x7d6446d5a1b0>
           │    └ <member 'impl' of 'QueryableAttribute' objects>
           └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x7d6448298040>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py", line 1096, in get
    value = self._fire_loader_callables(state, key, passive)
            │    │                      │      │    └ symbol('PASSIVE_OFF')
            │    │                      │      └ 'tweet_media_ids'
            │    │                      └ <sqlalchemy.orm.state.InstanceState object at 0x7d6446d5a1b0>
            │    └ <function AttributeImpl._fire_loader_callables at 0x7d6449007600>
            └ <sqlalchemy.orm.attributes.CollectionAttributeImpl object at 0x7d644832bd70>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py", line 1131, in _fire_loader_callables
    return self.callable_(state, passive)
           │    │         │      └ symbol('PASSIVE_OFF')
           │    │         └ <sqlalchemy.orm.state.InstanceState object at 0x7d6446d5a1b0>
           │    └ <member 'callable_' of 'AttributeImpl' objects>
           └ <sqlalchemy.orm.attributes.CollectionAttributeImpl object at 0x7d644832bd70>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/strategies.py", line 978, in _load_for_state
    return self._emit_lazyload(
           │    └ <function LazyLoader._emit_lazyload at 0x7d6448e0c540>
           └ <sqlalchemy.orm.strategies.LazyLoader object at 0x7d6446d4eb20>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/strategies.py", line 1141, in _emit_lazyload
    result = session.execute(
             │       └ <function Session.execute at 0x7d6448dfaac0>
             └ <sqlalchemy.orm.session.Session object at 0x7d6446d417f0>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x7d6448dfa840>
           └ <sqlalchemy.orm.session.Session object at 0x7d6446d417f0>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function AbstractORMCompileState.orm_execute_statement at 0x7d6449071ee0>)>
                   │      └ <class 'sqlalchemy.orm.context.ORMSelectCompileState'>
                   └ typing.Any
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x7d6449230a40>
             └ <sqlalchemy.engine.base.Connection object at 0x7d6446d40d10>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7d6446da8d70>>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7d6449230d60>
           └ <sqlalchemy.engine.base.Connection object at 0x7d6446d40d10>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7d6449230f40>
          └ <sqlalchemy.engine.base.Connection object at 0x7d6446d40d10>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x7d6449230fe0>
           └ <sqlalchemy.engine.base.Connection object at 0x7d6446d40d10>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7d6449231260>
    └ <sqlalchemy.engine.base.Connection object at 0x7d6446d40d10>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2366, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
          │                          └ (<class 'sqlalchemy.exc.MissingGreenlet'>, MissingGreenlet("greenlet_spawn has not been called; can't call await_only() here....
          └ (<class 'sqlalchemy.exc.MissingGreenlet'>, MissingGreenlet("greenlet_spawn has not been called; can't call await_only() here....
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7d64490c7a60>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x7d644862bb60>
    └ <sqlalchemy.engine.base.Connection object at 0x7d6446d40d10>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ (34,)
    │      │       └ 'SELECT media.id AS media_id, media.path AS media_path, media.tweet_id AS media_tweet_id \nFROM media \nWHERE $1::INTEGER = m...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x7d64488016c0>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x7d6446d5a5c0>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x7d6446d5a5c0>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 123, in await_only
    raise exc.MissingGreenlet(
          │   └ <class 'sqlalchemy.exc.MissingGreenlet'>
          └ <module 'sqlalchemy.exc' from '/usr/local/lib/python3.12/site-packages/sqlalchemy/exc.py'>

sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)
2026-02-20 12:57:21.132 | INFO     | application.routes:run_upgrade:54 - Migrations applied successfully
2026-02-20 12:57:28.139 | INFO     | application.routes:delete_tweet:244 - File /application/media/ed94ae13-0faa-48e7-bc13-5f72d5b64ee6.png deleted from disk
2026-02-20 12:57:28.157 | INFO     | application.routes:delete_tweet:248 - User Slava delete tweet: id = 34
2026-02-20 12:58:59.799 | INFO     | application.routes:run_upgrade:54 - Migrations applied successfully
2026-02-20 12:59:10.714 | INFO     | application.routes:upload_media:171 - Image: %s saved successful.
2026-02-20 12:59:10.728 | INFO     | application.routes:add_tweet:124 - Request completed: api/post/tweet
2026-02-20 12:59:10.820 | INFO     | application.routes:add_tweet:149 - Tweet %s successful saved.
2026-02-20 12:59:10.854 | INFO     | application.routes:auth_user:110 - request completed: api/users/me/%s
2026-02-20 12:59:10.867 | INFO     | application.routes:auth_user:112 - User not found
